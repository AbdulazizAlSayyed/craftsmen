  <html>
    <head>
      <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
      <link
        rel="stylesheet"
        as="style"
        onload="this.rel='stylesheet'"
        href="https://fonts.googleapis.com/css2?display=swap&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900&amp;family=Work+Sans%3Awght%40400%3B500%3B700%3B900"
      />

      <title>Galileo Design</title>
      <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

      <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    </head>
    <body>
      <div
        class="relative flex size-full min-h-screen flex-col bg-white group/design-root overflow-x-hidden"
        style="font-family: 'Work Sans', 'Noto Sans', sans-serif"
      >
        <div class="layout-container flex h-full grow flex-col">
          <header
            class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#f3eee7] px-10 py-3"
          >
            <div class="flex items-center gap-8">
              <div class="flex items-center gap-4 text-[#1b150d]">
                <div class="size-4">
                  <svg
                    viewBox="0 0 48 48"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      fill-rule="evenodd"
                      clip-rule="evenodd"
                      d="M12.0799 24L4 19.2479L9.95537 8.75216L18.04 13.4961L18.0446 4H29.9554L29.96 13.4961L38.0446 8.75216L44 19.2479L35.92 24L44 28.7521L38.0446 39.2479L29.96 34.5039L29.9554 44H18.0446L18.04 34.5039L9.95537 39.2479L4 28.7521L12.0799 24Z"
                      fill="currentColor"
                    ></path>
                  </svg>
                </div>
                <h2
                  class="text-[#1b150d] text-lg font-bold leading-tight tracking-[-0.015em]"
                >
                  Craftsman
                </h2>
              </div>
              <div class="flex items-center gap-9">
                <a
                  class="text-[#1b150d] text-sm font-medium leading-normal"
                  href="dashboard.html"
                  >Dashboard</a
                >
                <a
                  class="text-[#1b150d] text-sm font-medium leading-normal"
                  href="job.html"
                  >Jobs</a
                >
                <a
                  class="text-[#1b150d] text-sm font-medium leading-normal"
                  href="myjob.html"
                  >My Jobs</a
                >
                <a
                  class="text-[#1b150d] text-sm font-medium leading-normal"
                  href="proposal.html"
                  >Proposals</a
                >
              </div>
            </div>
            <div class="flex flex-1 justify-end gap-8">
              <div class="flex gap-2">
                <a href="Notification.html">
                  <button
                    class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 bg-[#f3eee7] text-[#1b150d] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5"
                  >
                    <div
                      class="text-[#1b150d]"
                      data-icon="Bell"
                      data-size="20px"
                      data-weight="regular"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="20px"
                        height="20px"
                        fill="currentColor"
                        viewBox="0 0 256 256"
                      >
                        <path
                          d="M221.8,175.94C216.25,166.38,208,139.33,208,104a80,80,0,1,0-160,0c0,35.34-8.26,62.38-13.81,71.94A16,16,0,0,0,48,200H88.81a40,40,0,0,0,78.38,0H208a16,16,0,0,0,13.8-24.06ZM128,216a24,24,0,0,1-22.62-16h45.24A24,24,0,0,1,128,216ZM48,184c7.7-13.24,16-43.92,16-80a64,64,0,1,1,128,0c0,36.05,8.28,66.73,16,80Z"
                        ></path>
                      </svg>
                    </div>
                  </button>
                </a>
                <a href="chat.html">
                  <button
                    class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 bg-[#f3eee7] text-[#1b150d] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5"
                  >
                    <div
                      class="text-[#1b150d]"
                      data-icon="ChatCircleDots"
                      data-size="20px"
                      data-weight="regular"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="20px"
                        height="20px"
                        fill="currentColor"
                        viewBox="0 0 256 256"
                      >
                        <path
                          d="M140,128a12,12,0,1,1-12-12A12,12,0,0,1,140,128ZM84,116a12,12,0,1,0,12,12A12,12,0,0,0,84,116Zm88,0a12,12,0,1,0,12,12A12,12,0,0,0,172,116Zm60,12A104,104,0,0,1,79.12,219.82L45.07,231.17a16,16,0,0,1-20.24-20.24l11.35-34.05A104,104,0,1,1,232,128Zm-16,0A88,88,0,1,0,51.81,172.06a8,8,0,0,1,.66,6.54L40,216,77.4,203.53a7.85,7.85,0,0,1,2.53-.42,8,8,0,0,1,4,1.08A88,88,0,0,0,216,128Z"
                        ></path>
                      </svg>
                    </div>
                  </button>
                </a>
                <a href="Setting.html">
                  <!-- Settings Button -->
                  <button
                    class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 bg-[#f3eee7] text-[#1b150d] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5"
                  >
                    <div
                      class="text-[#1b150d]"
                      data-icon="Settings"
                      data-size="20px"
                      data-weight="regular"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="20px"
                        height="20px"
                        fill="currentColor"
                        viewBox="0 0 256 256"
                      >
                        <path
                          d="M224,136a8,8,0,0,1-8,8H192a32,32,0,0,1-64,0H40a8,8,0,0,1,0-16H128a32,32,0,0,1,64,0h24A8,8,0,0,1,224,136ZM128,96a32,32,0,0,1,64,0h24a8,8,0,0,1,0,16H192a32,32,0,0,1-64,0H40a8,8,0,0,1,0-16Z"
                        ></path>
                      </svg>
                    </div>
                  </button>
                </a>
              </div>
              <a href="#" id="profile-link">
                <div
                  id="profile-pic"
                  class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10"
                ></div>
              </a>
            </div>
          </header>
          <div class="px-40 flex flex-1 justify-center py-5">
            <div
              class="layout-content-container flex flex-col max-w-[960px] flex-1"
            >
              <div class="flex p-4 @container">
                <div
                  class="flex w-full flex-col gap-4 @[520px]:flex-row @[520px]:justify-between @[520px]:items-center"
                >
                  <div class="flex gap-4">
                    <img
                      id="craftsman-profile-pic"
                      class="rounded-full min-h-32 w-32"
                      src="default.png"
                      alt="Profile Image"
                    />

                    <div class="flex flex-col justify-center">
                      <p
                        id="craftsman-name"
                        class="text-[#181411] text-[22px] font-bold leading-tight tracking-[-0.015em]"
                      >
                        <!-- Name will be inserted here -->
                      </p>
                      
                        <!-- Bio will be inserted here -->
                      </p>
                      <p
                        id="craftsman-location"
                        class="text-[#897361] text-sm font-normal leading-normal"
                      >
                        <!-- Location will be inserted here -->
                      </p>
                    </div>
                  </div>
                  <div class="flex w-full max-w-[480px] gap-3 @[480px]:w-auto">
                    <button
                      class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 px-4 bg-[#f4f2f0] text-[#181411] text-sm font-bold leading-normal tracking-[0.015em] flex-1 @[480px]:flex-auto"
                    >
                      <span class="truncate">Hire Me</span>
                    </button>
                    <button
                      class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-xl h-10 px-4 bg-[#ec7113] text-white text-sm font-bold leading-normal tracking-[0.015em] flex-1 @[480px]:flex-auto"
                    >
                      <span class="truncate">Invite to Job</span>
                    </button>
                  </div>
                </div>
              </div>
            
              <h2
                class="text-[#181411] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5"
              >
                Abouts
              </h2>
              <p
                        id="craftsman-bio"
                        class="text-[#897361] text-base font-normal leading-normal"
                      >

              <h2
                class="text-[#181411] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5"
              >
                Skills
              </h2>
              <div id="skills-tabs" class="flex gap-3 p-3 flex-wrap pr-4">
                <!-- Skills will load here dynamically -->
              </div>

              <p
                id="skill-name"
                class="text-[#181411] text-lg font-bold leading-tight"
              ></p>
              <p id="skill-rank" class="text-sm text-gray-600"></p>
              <p id="skill-experience" class="text-sm text-gray-600"></p>
              <p id="skill-rating" class="text-sm text-gray-600"></p>

              <h2
                class="text-[#181411] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5"
              >
                Experience
              </h2>
              <div id="job-list"></div>

              <h2
                class="text-[#181411] text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5"
              >
                Education
              </h2>
              <div
                class="flex items-center gap-4 bg-white px-4 min-h-[72px] py-2"
              >
                <div
                  class="bg-center bg-no-repeat aspect-square bg-cover rounded-lg size-14"
                  style="
                    background-image: url('https://cdn.usegalileo.ai/sdxl10/7e289a29-7b15-4d4c-8930-7f5096918c85.png');
                  "
                ></div>
                <div class="flex flex-col justify-center">
                  <p
                    class="text-[#181411] text-base font-medium leading-normal line-clamp-1"
                  >
                    B.A. in Graphic Design
                  </p>
                  <p
                    class="text-[#897361] text-sm font-normal leading-normal line-clamp-2"
                  >
                    2009 - 2013
                  </p>
                </div>
              </div>
            </div>
          </div>

          <footer class="flex justify-center">
            <div class="flex max-w-[960px] flex-1 flex-col">
              <footer
                class="flex flex-col gap-6 px-5 py-10 text-center @container"
              >
                <div
                  class="flex flex-wrap items-center justify-center gap-6 @[480px]:flex-row @[480px]:justify-around"
                >
                  <a
                    class="text-[#897361] text-base font-normal leading-normal min-w-40"
                    href="#"
                    >About</a
                  >
                  <a
                    class="text-[#897361] text-base font-normal leading-normal min-w-40"
                    href="#"
                    >Help</a
                  >
                  <a
                    class="text-[#897361] text-base font-normal leading-normal min-w-40"
                    href="#"
                    >Careers</a
                  >
                  <a
                    class="text-[#897361] text-base font-normal leading-normal min-w-40"
                    href="#"
                    >Trust &amp; Safety</a
                  >
                  <a
                    class="text-[#897361] text-base font-normal leading-normal min-w-40"
                    href="#"
                    >Terms of Service</a
                  >
                  <a
                    class="text-[#897361] text-base font-normal leading-normal min-w-40"
                    href="#"
                    >Privacy Policy</a
                  >
                </div>
                <p class="text-[#897361] text-base font-normal leading-normal">
                  @2023 Craftsmen
                </p>
              </footer>
            </div>
          </footer>
        </div>
      </div>
      <script>
document.addEventListener("DOMContentLoaded", async () => {
  const urlParams = new URLSearchParams(window.location.search);
  const craftsmanId = urlParams.get("craftsmanId"); // Get craftsman ID from URL
  const skillName = urlParams.get("skill"); // Get skill name from URL

  // Debugging logs
  console.log("🔍 Extracted craftsmanId:", craftsmanId);
  console.log("🔍 Extracted skillName:", skillName);

  if (!craftsmanId || !skillName) {
    console.error("❌ Missing craftsmanId or skill in URL");
    return;
  }

  try {
    // ✅ Fetch profile data
    const profileRes = await fetch(`/api/profile/${craftsmanId}`);
    if (!profileRes.ok) throw new Error("Profile data fetch failed");

    const data = await profileRes.json();

    // ✅ Update Profile Info
    document.getElementById("craftsman-name").textContent = data.fullName || "Unknown";
    document.getElementById("craftsman-bio").textContent = data.bio || "No bio available";
    document.getElementById("craftsman-location").textContent = data.location || "Location not provided";

    const profilePic = document.getElementById("craftsman-profile-pic");
    profilePic.src = data.profileImage?.trim() ? data.profileImage : "/uploads/default.png";

    // ✅ Update Skill Section
    if (data.skills && data.skills.length > 0) {
      const skill = data.skills.find((s) => s.name === skillName);
      if (skill) {
        document.getElementById("skill-name").textContent = skill.name;
        document.getElementById("skill-rank").textContent = `Rank: ${skill.rank}`;
        document.getElementById("skill-experience").textContent = `Experience: ${skill.xpPoints} XP`;
        document.getElementById("skill-rating").textContent = `Rating: ${skill.rating.toFixed(1)}⭐ (${skill.numberOfRatedJobs} rated jobs)`;
      } else {
        console.warn(`⚠️ No skill found matching '${skillName}'`);
      }
    } else {
      console.warn("⚠️ No skills found for this craftsman");
    }

    // ✅ Fetch Completed Jobs Related to the Skill
    const jobRes = await fetch(`/api/jobs/completed/${craftsmanId}/${encodeURIComponent(skillName)}`);

    if (!jobRes.ok) throw new Error(`Failed to fetch completed jobs for ${skillName}`);

    const completedJobs = await jobRes.json();
    const jobList = document.getElementById("job-list");
    jobList.innerHTML = ""; // Clear previous content

    if (completedJobs.length > 0) {
      completedJobs.forEach((job) => {
        const jobElement = document.createElement("div");
        jobElement.className = "p-3 border rounded-lg shadow bg-gray-100 mb-3";

        jobElement.innerHTML = `
          <h3 class="font-bold text-lg">${job.title}</h3>
          <p class="text-sm text-gray-600">${job.description || "No description available."}</p>
          <p class="text-sm text-gray-700">💰 Budget: $${job.budget}</p>
          <p class="text-sm text-gray-700">📊 Level: ${job.jobRank}</p>
          ${
            job.ratings > 0
              ? `<p class="text-sm text-yellow-500">⭐ Rating: ${job.ratings.toFixed(1)} / 5</p>`
              : `<p class="text-sm text-gray-500">⭐ No rating available</p>`
          }
        `;

        jobList.appendChild(jobElement);
      });
    } else {
      jobList.innerHTML = `<p class="text-gray-500">No completed jobs found for ${skillName}.</p>`;
    }
  } catch (error) {
    console.error("❌ Failed to fetch profile data:", error);
  }
});
</script>
        

      <script>
        async function loadSkills(userId) {
          try {
            const response = await fetch(`/api/profile/${userId}/all-skills`);
            if (!response.ok) throw new Error("Failed to fetch skills");

            const { skills } = await response.json();

            const skillsTabs = document.getElementById("skills-tabs");
            skillsTabs.innerHTML = "";

            skills.forEach((skill) => {
              const skillTab = document.createElement("button");
              skillTab.className = "p-2 bg-gray-200 rounded-md";
              skillTab.textContent = skill.name;
              skillTab.onclick = () => {
                window.location.href = `profile2.html?craftsmanId=${userId}&skill=${skill.name}`;
              };
              skillsTabs.appendChild(skillTab);
            });
          } catch (error) {
            console.error("❌ Failed to load skills:", error);
          }
        }

        document.addEventListener("DOMContentLoaded", () => {
          const userId = new URLSearchParams(window.location.search).get(
            "craftsmanId"
          );
          if (userId) {
            loadSkills(userId);
          }
        });
      </script>

      <script>
        // this for profile to go to main skill
        document.addEventListener("DOMContentLoaded", async () => {
          const userId = new URLSearchParams(window.location.search).get(
            "craftsmanId"
          );

          if (!userId) {
            console.error("❌ Missing craftsmanId in URL");
            return;
          }

          try {
            // Fetch user profile data
            const res = await fetch(`/api/profile/${userId}`);
            if (!res.ok) throw new Error("Failed to fetch profile");

            const data = await res.json();

            // Get main skill (first skill)
            const mainSkill = data.skills?.length
              ? data.skills[0].name
              : "General";

            //abd now
            // Set profile image (or default if unavailable)
            //const profilePicDiv = document.getElementById("profile-pic");
            //profilePicDiv.style.backgroundImage = `url(${
            //  data.profileImage || "/uploads/default.png"
            //})`;

            const profilePicDiv = document.getElementById("profile-pic");
            if (profilePicDiv) {
              profilePicDiv.style.backgroundImage = `url('${
                data.profileImage?.trim() || "/uploads/default.png"
              }')`;
            } else {
              console.error("❌ Element #profile-pic not found in the DOM");
            }

            // Make the image a clickable link to the profile page with main skill
            const profileLink = document.getElementById("profile-link");
            profileLink.href = `Profile2.html?craftsmanId=${userId}&skill=${encodeURIComponent(
              mainSkill
            )}`;
          } catch (err) {
            console.error("❌ Error loading profile:", err);
          }
        });
      </script>
    </body>
  </html>
